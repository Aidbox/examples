{
  "resourceType": "Bundle",
  "type": "transaction",
  "entry": [
    {
      "resource": {
        "resourceType": "Client",
        "id": "health-cards-client",
        "secret": "secret",
        "grant_types": ["basic"]
      },
      "request": {
        "method": "PUT",
        "url": "Client/health-cards-client"
      }
    },
    {
      "resource": {
        "resourceType": "AccessPolicy",
        "id": "basic-policy",
        "engine": "allow",
        "link": [
          {
            "id": "health-cards-client",
            "resourceType": "Client"
          }
        ]
      },
      "request": {
        "method": "PUT",
        "url": "AccessPolicy/health-cards-access-policy"
      }
    },
    {
      "resource": {
        "resourceType": "App",
        "id": "health-cards-app",
        "type": "app",
        "apiVersion": 1,
        "endpoint": {
          "url": "http://health-cards-app:3000/health-cards-issue",
          "secret": "health-cards-app-secret"
        },
        "operations": {
          "health-cards-issue": {
            "method": "POST",
            "path": ["fhir", "Patient", { "name": "id" }, "$health-cards-issue"]
          },
          "well-known-jwks": {
            "path": [
              "health-cards-app",
              ".well-known",
              "jwks.json"
            ],
            "method": "GET"
          }
        }
      },
      "request": {
        "method": "PUT",
        "url": "App/health-cards-app"
      }
    },
    {
      "request": {
        "method": "POST",
        "url": "$drop-cache"
      }
    },
    {
      "resource": {
        "resourceType": "Patient",
        "id": "example-patient",
        "meta": {
          "profile": [
            "http://hl7.org/fhir/us/core/StructureDefinition/us-core-patient"
          ]
        },
        "identifier": [
          {
            "use": "usual",
            "type": {
              "coding": [
                {
                  "system": "http://terminology.hl7.org/CodeSystem/v2-0203",
                  "code": "MR",
                  "display": "Medical Record Number"
                }
              ]
            },
            "system": "http://example.org/medical-record-numbers",
            "value": "12345"
          }
        ],
        "active": true,
        "name": [
          {
            "use": "official",
            "family": "Doe",
            "given": ["John"]
          }
        ],
        "telecom": [
          {
            "system": "phone",
            "value": "555-123-4567",
            "use": "home"
          },
          {
            "system": "email",
            "value": "john.doe@example.com",
            "use": "home"
          }
        ],
        "gender": "male",
        "birthDate": "1980-01-01",
        "address": [
          {
            "use": "home",
            "line": ["123 Main St"],
            "city": "Anytown",
            "state": "CA",
            "postalCode": "12345",
            "country": "US"
          }
        ]
      },
      "request": {
        "method": "PUT",
        "url": "Patient/example-patient"
      }
    },
    {
      "resource": {
        "resourceType": "Immunization",
        "id": "example-covid-vaccination",
        "status": "completed",
        "vaccineCode": {
          "coding": [
            {
              "system": "http://hl7.org/fhir/sid/cvx",
              "code": "208",
              "display": "COVID-19, mRNA, LNP-S, PF, 30 mcg/0.3 mL dose"
            }
          ]
        },
        "patient": {
          "reference": "Patient/example-patient"
        },
        "occurrenceDateTime": "2023-03-15",
        "recorded": "2023-03-15",
        "primarySource": true,
        "lotNumber": "ABC123",
        "expirationDate": "2024-12-31",
        "site": {
          "coding": [
            {
              "system": "http://terminology.hl7.org/CodeSystem/v3-ActSite",
              "code": "LA",
              "display": "left arm"
            }
          ]
        },
        "route": {
          "coding": [
            {
              "system": "http://terminology.hl7.org/CodeSystem/v3-RouteOfAdministration",
              "code": "IM",
              "display": "Intramuscular"
            }
          ]
        },
        "doseQuantity": {
          "value": 0.3,
          "unit": "mL",
          "system": "http://unitsofmeasure.org",
          "code": "mL"
        },
        "performer": [
          {
            "function": {
              "coding": [
                {
                  "system": "http://terminology.hl7.org/CodeSystem/v2-0443",
                  "code": "AP",
                  "display": "Administering Provider"
                }
              ]
            },
            "actor": {
              "display": "Dr. Jane Smith, MD"
            }
          }
        ],
        "protocolApplied": [
          {
            "series": "COVID-19 Primary Series",
            "doseNumberPositiveInt": 1,
            "seriesDosesPositiveInt": 2
          }
        ]
      },
      "request": {
        "method": "PUT",
        "url": "Immunization/example-covid-vaccination"
      }
    },
    {
      "resource": {
        "resourceType": "Observation",
        "id": "example-covid-test",
        "status": "final",
        "category": [
          {
            "coding": [
              {
                "system": "http://terminology.hl7.org/CodeSystem/observation-category",
                "code": "laboratory",
                "display": "Laboratory"
              }
            ]
          }
        ],
        "code": {
          "coding": [
            {
              "system": "http://loinc.org",
              "code": "94500-6",
              "display": "SARS-CoV-2 (COVID-19) RNA [Presence] in Respiratory specimen by NAA with probe detection"
            }
          ]
        },
        "subject": {
          "reference": "Patient/example-patient"
        },
        "effectiveDateTime": "2023-03-10",
        "valueCodeableConcept": {
          "coding": [
            {
              "system": "http://snomed.info/sct",
              "code": "260385009",
              "display": "Negative"
            }
          ]
        },
        "performer": [
          {
            "display": "Example Lab"
          }
        ]
      },
      "request": {
        "method": "PUT",
        "url": "Observation/example-covid-test"
      }
    }
  ]
}
